define("game",[],function(){var e=function(){},t=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e.prototype[n]=t[n])};return t(e,{getPlayer:function(e){return this.getPlayerBy(function(t){return t.playerID==e})},getPlayerWithTurn:function(){return this.getPlayerBy(function(e){return e.status=="has_turn"})},getPlayers:function(e){return this.players.filter(e)},getPlayerBy:function(e){var t=this.getPlayers(e);return t.length?t[0]:null},getPlayerColor:function(e){var t=this.getPlayer(e);return t.playerColor},getOwnColor:function(){return this.getPlayerColor(this.ownPlayerID)},getOwnPlayer:function(){return this.getPlayer(this.ownPlayerID)},hasTurn:function(){var e=this.getOwnPlayer();return e.status=="has_turn"},isOver:function(){return this.status=="game_is_over"},getWinner:function(){return this.getPlayerBy(function(e){return e.status=="winner"})},initialize:function(e){this.loadMeta(e),this.state=e.state},loadMeta:function(e){this.players=e.players,this.status=e.status,this.ownPlayerID=e.ownPlayerID},getRow:function(e){return this.state["row_"+e]},canPlace:function(e){var t=this.getRow(e);return this.hasTurn()&&t.length<6}}),e}),define("app",["game"],function(e){return{launch:function(){var t=new e,n=!1;Plynd.getGame(function(e){t.initialize(e),r(),Plynd.Realtime.onEvent(o)});var r=function(){$("#board").empty();for(var e=0;e<7;e++){var n=i(e);$("#board").append(n)}var r;if(t.isOver()){var s=t.getWinner();s.playerID==t.ownPlayerID?r="You won the game":r=s.playerName+" won the game"}else r=t.hasTurn()?"It is your turn":"It is "+t.getPlayerWithTurn().playerName+"'s turn";$("#turn").text(r)},i=function(e){var r=t.getRow(e),i=$("<div/>",{"class":"row"});r.map(function(e){var n=$("<div/>",{"class":"gem player"});n.css("background-color",t.getPlayerColor(e)),i.prepend(n)});for(var u=0;u<6-r.length;u++)i.prepend($("<div/>",{"class":"gem available"}));return i.on("mouseenter",function(){!n&&t.canPlace(e)&&(i.find(".available").last().css({"background-color":t.getOwnColor(),opacity:.6}),i.css("cursor","pointer"))}),i.on("mouseleave",function(){n||(i.find(".available").css({"background-color":"",opacity:1}),i.css("cursor",""))}),i.on("click",function(){!n&&t.canPlace(e)&&(n=!0,Plynd.sendNewEvent({row:e},o,s))}),i},s=function(){n=!1},o=function(e,n){var i=t.getRow(e.row);i.push(e.playerID),t.loadMeta(n),r(),s()}}}});